# DPB-003: OpenReviewクライアント実装

## 基本情報

| 項目       | 内容                       |
| ---------- | -------------------------- |
| タスクID   | DPB-003                    |
| タスク名   | OpenReviewクライアント実装 |
| Phase      | Phase 1: コア機能          |
| 優先度     | 必須                       |
| ステータス | 完了                       |
| 関連機能ID | F-04 (仕様書 Sec. 4)       |
| 関連画面ID | -                          |

## 概要

OpenReview APIにアクセスし、指定されたカンファレンスの論文情報を取得するためのクライアントを実装します。

## やること

- [x] `internal/openreview` パッケージを作成する。
- [x] OpenReview APIのエンドポイントに対してHTTPリクエストを送信する機能を実装する。
- [x] APIレスポンス（JSON）をパースし、Goの構造体にマッピングする。
- [x] 仕様書で定義された必須項目（paper_id, title, authors, abstractなど）を取得する。
- [x] APIリクエスト失敗時のエラーハンドリングを実装する。

## 方針

- Goの標準HTTPクライアント (`net/http`) を使用する。
- JSONのデコードには `encoding/json` を使用する。
- OpenReviewのAPI仕様（エンドポイント、パラメータ）を調査し、`venue` や `invitation` を指定して論文リストを取得する方法を確立する。
- APIからの取得結果を表現する `Paper` 構造体を定義する。

## 方法

### 1. APIスキーマに基づいた構造体の定義

OpenReview API v2のスキーマに基づき、レスポンスをマッピングするためのGo構造体を定義します。`content`フィールド内の `{"value": ...}` という構造に対応するため、ジェネリクスを利用した`ValueField`を導入します。

```go
// internal/openreview/openreview.go

// Note は論文一件の情報を保持するオブジェクトです。
type Note struct {
	ID      string      `json:"id"`
	CDate   int64       `json:"cdate"`
	Content NoteContent `json:"content"`
}

// NoteContent は論文の具体的な内容を保持します。
type NoteContent struct {
	Title    ValueField[string]   `json:"title"`
	Authors  ValueField[[]string] `json:"authors"`
	Abstract ValueField[string]   `json:"abstract"`
	PDF      ValueField[string]   `json:"pdf,omitempty"`
	Bibtex   ValueField[string]   `json:"_bibtex,omitempty"`
}

// ValueField は {"value": T} の構造を表現するためのジェネリックな型です。
type ValueField[T any] struct {
	Value T `json:"value"`
}
```

### 2. クライアントの実装

APIのベースURLをクライアントのフィールドとして持つようにリファクタリングし、テスト容易性を向上させます。

```go
// internal/openreview/openreview.go

type Client struct {
	httpClient *http.Client
	BaseURL    string
}

func NewClient() *Client {
	return &Client{
		httpClient: &http.Client{Timeout: 30 * time.Second},
		BaseURL:    "https://api2.openreview.net",
	}
}

func (c *Client) GetNotes(venue string) ([]Note, error) {
	url := fmt.Sprintf("%s/notes?invitation=%s/-/Submission", c.BaseURL, venue)
    // ... (HTTPリクエストとレスポンス処理)
}
```

## 成果物

- [x] `internal/openreview` パッケージ
- [x] OpenReview API v2から論文情報を取得する `GetNotes` 関数
- [x] 実際のAPIと通信してデータ取得を検証する統合テスト

## 依存タスク

- DPB-001: プロジェクト初期設定と基本構造

## 後続タスク

- DPB-007: メインプロセスと実行フローの統括
