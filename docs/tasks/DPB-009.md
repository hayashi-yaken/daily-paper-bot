# DPB-009: 複数学会対応のための設定機能改修

## 基本情報

| 項目       | 内容                             |
| ---------- | -------------------------------- |
| タスクID   | DPB-009                          |
| タスク名   | 複数学会対応のための設定機能改修 |
| Phase      | Phase 3: 拡張機能                |
| 優先度     | 高                               |
| ステータス | 完了                             |
| 関連機能ID | -                                |
| 関連画面ID | -                                |

## 概要

複数の学会（ICLR, ICML, NeurIPSなど）を対象にできるように、単一の学会しか扱えなかった設定機能を拡張します。環境変数にJSON形式で複数の学会情報を定義できるようにします。

## やること

- [x] `internal/config` の `Config` 構造体を変更し、単一のVenue情報ではなく、Venue情報のスライス（配列）を保持できるようにする。
- [x] 新しい環境変数 `OR_VENUES_JSON` を定義し、そのJSON文字列をパースして設定に読み込むロジックを実装する。
- [x] これまでの `OR_VENUE`, `OR_YEAR`, `OR_VENUE_URL` は廃止する。
- [x] `main.go` で設定を読み込んでいる部分のコンパイルエラーを一時的に修正する（後続のチケットで本格的に修正）。

## 方針

- 学会情報は、名前、API用のvenue ID、年、ウェブページのURLなどを含む構造体として定義する。
- 環境変数にJSON文字列で設定を定義することで、柔軟な学会リストの管理を可能にする。
  - 例: `export OR_VENUES_JSON='[{"name":"ICLR", "venue":"ICLR.cc/2025/Conference", ...}]'`

## 方法

### 1. 新しい学会設定の構造を定義

```go
// internal/config/config.go

// VenueConfig は一つの学会に関する設定を保持します。
type VenueConfig struct {
	Name     string `json:"name"`     // 表示名 (例: "ICLR")
	Venue    string `json:"venue"`    // API用Venue ID
	Year     int    `json:"year"`     // 年
	VenueURL string `json:"venueURL"` // ブラウザ表示用URL
}

// Config 構造体を修正
type Config struct {
	// OpenReview
	Venues []VenueConfig // 複数学会を保持

	// (その他の設定は変更なし)
	// ...
}
```

### 2. JSON環境変数の読み込み

```go
// internal/config/config.go

func Load() (*Config, error) {
	cfg := &Config{}

	// OR_VENUES_JSONから学会リストを読み込む
	venuesJSON := os.Getenv("OR_VENUES_JSON")
	if venuesJSON == "" {
		return nil, fmt.Errorf("environment variable OR_VENUES_JSON is required")
	}
	if err := json.Unmarshal([]byte(venuesJSON), &cfg.Venues); err != nil {
		return nil, fmt.Errorf("failed to parse OR_VENUES_JSON: %w", err)
	}
	if len(cfg.Venues) == 0 {
		return nil, fmt.Errorf("no venues found in OR_VENUES_JSON")
	}

	// (その他の設定読み込み処理)
	// ...

	return cfg, nil
}
```

## 成果物

- [x] 複数学会を扱えるように更新された `internal/config` パッケージ
- [x] ユニットテストの修正

## 依存タスク

なし

## 後続タスク

- DPB-010: 実行対象の学会を選定するロジックの実装
- DPB-011: 複数学会対応のメインプロセス統合
